<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="../resources/css/common.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>한국 폐암환우회</title>

</head>
<body>
<script>
    $(document).on("click", ".consultBtn", function(e) {
        var seqs = $(this).val();    // 클릭된 수정버튼의 id값 변수에 담기

        var memo = $(this).closest("tr").find("td:eq(5)").text().trim(); // 수정할 메모 내용 추출

        $.ajax({
            url: '/consult_list_edit', // 수정 페이지 URL로 변경
            dataType: 'json',
            type: 'GET',
            data: {
                seq: seqs,
            },
            success: function(result) {
                var updatebtn = e.target.parentElement.parentElement.parentElement;

                if (result) {
                    updatebtn.children[5].innerHTML = `
                <form action="/consult_list_edit" method="post">
                    <textarea name="memo" id="edit-box" autocomplete="off">${memo}</textarea>
                    <button id="update-complete-btn" value="${seqs}" type="submit">완료</button>
                    <button id="cancel-btn" type="button">취소</button>
                </form>
                `;
                }
            }
        });
    });
</script>

<div id="all">
    <nav class="navbar navbar-expand-sm" style="margin-top: 1%; margin-bottom: 1%;">
        <div class="container-fluid">
            <div class="logo-li"><a href="/"><img src="../resources/images/logo.png" class="imgLogo"></a></div>

            <div class="collapse navbar-collapse justify-content-center" id="collapsibleNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">소개</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="/greeting">인사말</a>
                            <a class="dropdown-item" href="/trace">발자취</a>
                            <a class="dropdown-item" href="/tree">조직도</a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">사업 안내</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="/breath_program">새숨 프로그램</a>
                            <a class="dropdown-item" href="/breath_walk">새숨 걷기</a>
                            <a class="dropdown-item" href="/consult">새숨 전화 상담</a>
                            <a class="dropdown-item" href="/activity">대외 활동</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">암 치료정보</a>
                        <div class="dropdown-menu">
<!--                            <a class="dropdown-item" href="/lung">폐암이란</a>-->
                            <a class="dropdown-item" href="/question">자주 묻는 질문</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">소식</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="/notice">공지사항</a>
                            <a class="dropdown-item" href="/gallery">갤러리</a>
                            <a class="dropdown-item" href="/news">복지 뉴스</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown"
                           aria-haspopup="true" aria-expanded="false">후원</a>
                        <div class="dropdown-menu">
                            <!--              <a class="dropdown-item" href="/donation">후원 신청</a>-->
                            <a class="dropdown-item" href="/donation_manage">후원금 운영</a>
                        </div>
                    </li>
                    <!--                    <li class="nav-item ms-auto"> &lt;!&ndash; ms-auto 클래스로 변경 &ndash;&gt;-->
                    <!--                        <a class="nav-link" href="#">관리자 로그인</a>-->
                    <!--                    </li>-->
                </ul>
            </div>
        </div>
    </nav>
    <div class="middle">
        <div class="sub_header">
            <div class="sub_category">
                <div class="sub_menu">
                    <a href="/donation_manage"><span class="sub_menu_text">후원금 운영</span></a>
                </div>
            </div>

        </div>
        <div class="content_outer">
            <div class="content"  style="margin-top: 2%; margin-bottom: 2%;">
                <span class="big-green">새숨 전화 상담 목록<br/></span>
                <p class="normal-charcoal">메모로 상담 여부를 관리할 수 있습니다.</p><br/><br/>

                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">번호</th>

                        <th scope="col">이름</th>

                        <th scope="col">번호</th>
                        <th scope="col">제목</th>

                        <th scope="col">내용</th>
                        <th scope="col">메모</th>

                    </tr>
                    </thead>
                    <tbody>

                    <tr th:each="consult : ${consultList}">
                        <td th:text="${consult.seq}" style="width: 50px;"></td>
                        <td th:text="${consult.author}" style="width: 60px;"></td>
                        <td th:text="${consult.phone}"  style="width: 100px;"></td>
                        <td th:text="${consult.title}"  style="width: 200px;"></td>
                        <td th:text="${consult.content}"></td>
                        <td th:text="${consult.memo}"></td>
                        <td><button id="updateBtn" value="${consult.seq}" type="button" class="consultBtn">수정</button></td>
                    </tr>
                    </tbody>

                </table>

<!--                <div>-->
<!--                    <button id="updateBtn" value="${consult.seq}" type="button" class="consultBtn">수정</button>-->
<!--                </div>-->
                <br/>


            </div>
        </div>

    </div>
</div>
<footer>
    비영리법인 한국폐암환우회 | 고유번호 : 507- 82 -72452 | 주소 : 경기도 김포시 고촌읍 김포대로 340, 1동 703호 (김포뉴시티) | Tel : 010-4467-8275
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
